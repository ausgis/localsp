<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Local Indicator of Stratified Power • localsp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Local Indicator of Stratified Power">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">localsp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/lisp.html">Local Indicator of Stratified Power (LISP)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ausgis/localsp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Local Indicator of Stratified Power</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ausgis/localsp/blob/main/vignettes/lisp.Rmd" class="external-link"><code>vignettes/lisp.Rmd</code></a></small>
      <div class="d-none name"><code>lisp.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-the-localsp-package">Introduction to the <strong>localsp</strong> package<a class="anchor" aria-label="anchor" href="#introduction-to-the-localsp-package"></a>
</h2>
<div class="section level3">
<h3 id="this-package-can-be-used-to-address-following-issues">1.1 This package can be used to address following issues:<a class="anchor" aria-label="anchor" href="#this-package-can-be-used-to-address-following-issues"></a>
</h3>
<ul>
<li><p>Identify local power of individual determinants.</p></li>
<li><p>Explore how spatial stratified association changes spatially and
in local regions.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="how-to-install-this-package">1.2 How to install this package:<a class="anchor" aria-label="anchor" href="#how-to-install-this-package"></a>
</h3>
<ul>
<li>Install the stable version, please use:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"localsp"</span>, dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Install the development version, please use:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"localsp"</span>,</span>
<span>                 repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://ausgis.r-universe.dev"</span>,</span>
<span>                           <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span>,</span>
<span>                 dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>1.3 General calculation process of LISP model:</p>
<p>Figure 1 shows the process of LISP, comprising three sequential
steps. First, the optimal extent for local is identified using a spatial
variogram to satisfy the criterion of a sufficiently small range and
ensure that the data within the extent exhibit adequate heterogeneity
and association. The second step is to analyze the PD of individual
variables on the response variable through GD modeling with optimal
spatial discretization algorithms and parameters at the local scale. The
final step is to quantify the local PD of interaction variables,
including the interaction of a pair of spatial variables and the
interaction of multiple variables, using a tree-based spatial
discretization approach and stratified heterogeneity approaches.</p>
<div class="float">
<img src="../reference/figures/lisp/flowchart.jpg" width="500" alt="Figure 1. The technical flowchart of the local indicator of stratified power (LISP) for examining the local power of determinants. (Hu et al. 2024)"><div class="figcaption">
<strong>Figure 1</strong>. The technical
flowchart of the local indicator of stratified power (LISP) for
examining the local power of determinants. (<a href="https://doi.org/10.1080/13658816.2024.2437811" class="external-link">Hu et
al. 2024</a>)</div>
</div>
</div>
<div class="section level3">
<h3 id="example-data-in-this-package">1.4 Example data in this package:<a class="anchor" aria-label="anchor" href="#example-data-in-this-package"></a>
</h3>
<p>The <code>gtc.csv</code> dataset documents glacier thickness changes
(GTC) from 2000 to 2020, along with potential influencing factors in the
Greater Himalayas, encompassing the Hengduan Mountains, Himalayas,
Nyainqentanglha Mountains, Karakoram, and Hindu Kush (see Figure2).
Variables such as <em>WinTem</em>, <em>SumTem</em>, and <em>Pre</em>
represent the linear trends of winter temperature, summer temperature,
and precipitation over the 2000–2020 period. <em>Elev</em>,
<em>Aspect</em>, and <em>Slope</em> are derived from NASADEM data and
correspond to elevation, aspect, and slope, respectively.
<em>LakeArea</em> indicates the area of glacial lakes, while
<em>SurAlbedo</em>, calculated from MODIS products, represents the
surface albedo of glaciers.</p>
<div class="float">
<img src="../reference/figures/lisp/studyarea.jpg" width="500" alt="Figure 2. Spatial distribution of the thickness variations of lake-terminating glaciers in the Greater Himalayas. The dots in the chart represent the thickness variations of lake-terminating glaciers. The histogram in the figure shows the frequency of thickness changes at the terminus of glaciers connected to glacier lakes. (Hu et al. 2024)"><div class="figcaption">
<strong>Figure 2</strong>. Spatial distribution
of the thickness variations of lake-terminating glaciers in the Greater
Himalayas. The dots in the chart represent the thickness variations of
lake-terminating glaciers. The histogram in the figure shows the
frequency of thickness changes at the terminus of glaciers connected to
glacier lakes. (<a href="https://doi.org/10.1080/13658816.2024.2437811" class="external-link">Hu et
al. 2024</a>)</div>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gtc</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/gtc.csv"</span>, package <span class="op">=</span> <span class="st">"localsp"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rows: 908 Columns: 11</span></span>
<span><span class="co">## ── Column specification ────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## dbl (11): X, Y, GTC, Slope, Elev, LakeArea, WinTem, SumTem, Pre, Aspect, SurAlbedo</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="va">gtc</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">gtc</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">gtc</span></span>
<span><span class="co">## Simple feature collection with 908 features and 9 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 69.435 ymin: 27.4918 xmax: 102.75 ymax: 37.1104</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 908 × 10</span></span>
<span><span class="co">##       GTC  Slope  Elev LakeArea    WinTem  SumTem   Pre   Aspect SurAlbedo          geometry</span></span>
<span><span class="co">##  *  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;POINT [°]&gt;</span></span>
<span><span class="co">##  1 -0.766 0.0369  139.    4750.  0.00245   0.318  14.3  0.000233   0.0220  (75.7125 34.5219)</span></span>
<span><span class="co">##  2 -0.948 0.124   137.    4559.  0.00131   0.281  12.6  0.000379   0.0123   (76.0715 34.343)</span></span>
<span><span class="co">##  3 -2.05  0.411   154.    4428.  0.000229 -0.192   7.70 0.000429   0.0121  (90.2298 28.1097)</span></span>
<span><span class="co">##  4 -0.525 0.0101  296.    4272.  0.00215   0.234  17.1  0.00130    0.0332  (72.7349 35.7435)</span></span>
<span><span class="co">##  5 -0.950 0.0597  229.    5845.  0.000472  0.0204 28.7  0.00174    0.0262  (88.6606 27.9974)</span></span>
<span><span class="co">##  6 -1.88  0.991   137.    5371.  0.000472 -0.0492 16.3  0.00174    0.0262   (88.687 27.9951)</span></span>
<span><span class="co">##  7 -2.55  1.28    126.    5477.  0.000472 -0.294  14.5  0.00174    0.0262  (88.7123 27.9911)</span></span>
<span><span class="co">##  8 -0.909 0.0444  217.    4691.  0.00155   0.326  17.3  0.00175    0.0359  (75.3851 35.3621)</span></span>
<span><span class="co">##  9 -3.94  0.406   161.    3912. -0.000868  0.0490  7.88 0.00177    0.00379 (96.5057 29.4569)</span></span>
<span><span class="co">## 10 -0.819 0.0122  153.    4066. -0.000529 -0.0356  6.40 0.00178    0.0415  (71.9206 36.3066)</span></span>
<span><span class="co">## # ℹ 898 more rows</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="case-study-identifying-local-stratified-determinants-of-mountain-glacier-thickness">Case study: identifying local stratified determinants of Mountain
glacier thickness<a class="anchor" aria-label="anchor" href="#case-study-identifying-local-stratified-determinants-of-mountain-glacier-thickness"></a>
</h2>
<div class="section level3">
<h3 id="local-extent-exploration">2.1 Local extent exploration<a class="anchor" aria-label="anchor" href="#local-extent-exploration"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v</span> <span class="op">=</span> <span class="fu">automap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/automap/man/autofitVariogram.html" class="external-link">autofitVariogram</a></span><span class="op">(</span><span class="va">GTC</span> <span class="op">~</span> <span class="fl">1</span>,<span class="va">gtc</span><span class="op">)</span></span>
<span><span class="va">v</span></span>
<span><span class="co">## $exp_var</span></span>
<span><span class="co">##     np       dist      gamma dir.hor dir.ver   id</span></span>
<span><span class="co">## 1   11  0.3389571 0.06079091       0       0 var1</span></span>
<span><span class="co">## 2    7  0.6293936 0.06652231       0       0 var1</span></span>
<span><span class="co">## 3   10  0.9278894 0.17501639       0       0 var1</span></span>
<span><span class="co">## 4   16  1.2492295 0.14382694       0       0 var1</span></span>
<span><span class="co">## 5   26  1.7004611 0.41004265       0       0 var1</span></span>
<span><span class="co">## 6  117  2.4469826 0.23342367       0       0 var1</span></span>
<span><span class="co">## 7  137  3.6686816 0.30107541       0       0 var1</span></span>
<span><span class="co">## 8  261  5.2154522 0.30447724       0       0 var1</span></span>
<span><span class="co">## 9  322  7.0108583 0.30203198       0       0 var1</span></span>
<span><span class="co">## 10 309  8.8443752 0.35842465       0       0 var1</span></span>
<span><span class="co">## 11 435 10.9281487 0.36289139       0       0 var1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $var_model</span></span>
<span><span class="co">##   model      psill   range kappa</span></span>
<span><span class="co">## 1   Nug 0.03547043 0.00000     0</span></span>
<span><span class="co">## 2   Ste 0.26631800 1.24462    10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sserr</span></span>
<span><span class="co">## [1] 0.3693861</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "autofitVariogram" "list"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/localsp/lee-1.png" alt="Figure 3. The process of deriving the local extent using the semivariogram function between the semivariance of glacier thickness change and distance."><div class="figcaption">
<strong>Figure 3</strong>. The process of
deriving the local extent using the semivariogram function between the
semivariance of glacier thickness change and distance.</div>
</div>
</div>
<div class="section level3">
<h3 id="local-power-of-determinants-of-individual-variables">2.2 Local power of determinants of individual variables<a class="anchor" aria-label="anchor" href="#local-power-of-determinants-of-individual-variables"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">threshold</span> <span class="op">=</span> <span class="va">v</span><span class="op">$</span><span class="va">var_model</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">4</span></span>
<span><span class="va">distmat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/sf_coordinates.html" class="external-link">sf_coordinates</a></span><span class="op">(</span><span class="va">gtc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lpd</span> <span class="op">=</span> <span class="fu">localsp</span><span class="fu">::</span><span class="fu"><a href="../reference/lisp.html">lisp</a></span><span class="op">(</span><span class="va">GTC</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">gtc</span>, <span class="va">threshold</span>, <span class="va">distmat</span>, cores <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">lpd</span></span>
<span><span class="co">## # A tibble: 908 × 16</span></span>
<span><span class="co">##    pd_Slope sig_Slope pd_Elev sig_Elev pd_LakeArea sig_LakeArea pd_WinTem sig_WinTem pd_SumTem</span></span>
<span><span class="co">##       &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">##  1    0.111  1.57e- 1  0.0721 0.00289        0.109     3.58e- 3    0.0808    0.329      0.138 </span></span>
<span><span class="co">##  2    0.120  1.86e- 1  0.0716 0.00415        0.105     6.24e- 3    0.0833    0.281      0.137 </span></span>
<span><span class="co">##  3    0.216  4.82e-10  0.0774 0.000290       0.346     5.49e-10    0.0474    0.0341     0.0232</span></span>
<span><span class="co">##  4    0.141  2.40e- 2  0.132  0.000768       0.124     7.29e- 3    0.0291    0.540      0.175 </span></span>
<span><span class="co">##  5    0.250  6.88e-10  0.0777 0.00192        0.226     4.14e- 5    0.0227    0.583      0.0179</span></span>
<span><span class="co">##  6    0.249  7.64e-10  0.0776 0.00188        0.226     3.87e- 5    0.0228    0.580      0.0182</span></span>
<span><span class="co">##  7    0.249  7.64e-10  0.0776 0.00188        0.226     3.87e- 5    0.0228    0.580      0.0182</span></span>
<span><span class="co">##  8    0.121  2.02e- 1  0.0674 0.0183         0.114     4.25e- 3    0.0544    0.319      0.250 </span></span>
<span><span class="co">##  9    0.288  2.16e- 3  0.0706 0.0301         0.368     2.95e-10    0.0971    0.00661    0.0723</span></span>
<span><span class="co">## 10    0.179  2.45e- 2  0.121  0.0121         0.133     1.69e- 3    0.0297    0.799      0.235 </span></span>
<span><span class="co">## # ℹ 898 more rows</span></span>
<span><span class="co">## # ℹ 7 more variables: sig_SumTem &lt;dbl&gt;, pd_Pre &lt;dbl&gt;, sig_Pre &lt;dbl&gt;, pd_Aspect &lt;dbl&gt;, sig_Aspect &lt;dbl&gt;,</span></span>
<span><span class="co">## #   pd_SurAlbedo &lt;dbl&gt;, sig_SurAlbedo &lt;dbl&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p>Hu, J., Song, Y., &amp; Zhang, T. (2024). A local indicator of
stratified power. International Journal of Geographical Information
Science, 1–19. <a href="https://doi.org/10.1080/13658816.2024.2437811" class="external-link">https://doi.org/10.1080/13658816.2024.2437811</a>.</p>
<p> </p>
<p> </p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>, <a href="https://yongzesong.com/" class="external-link">Yongze Song</a>, <a href="https://www.researchgate.net/profile/Jiao-Hu-8" class="external-link">Jiao Hu</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
